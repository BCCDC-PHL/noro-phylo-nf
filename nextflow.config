manifest {
    author = 'John Palmer <john.palmer@bccdc.ca>'
    name = 'BCCDC-PHL/noro-typing-nf'
    version = '0.2.0'
    description = 'BCCDC-PHL Norovirus Metagenomics Pipeline'
    mainScript = 'main.nf'
    nextflowVersion = '>=20.01.0'
}

params {
    virus_name = 'norovirus'
    profile = false
    cache = ''
    run_name = ''
    input_dir = ''
    sequences = ''
    metadata = "NO_FILE"
    reference = "${projectDir}/assets/norovirus_g1_reference.fasta"
    outdir = 'results'

    tree_method = 'iqtree'
    time_tree = false
    divergence_units = "mutations-per-site"
    root_name = 'NC_001959.2'

    reference_annotation = 'NO_FILE'
    recursion_limit = 1000
    
}


process {

    withLabel: medium {
        cpus = 8
        memory = 16.GB
    }
    withLabel: heavy {
        cpus = 16
        memory = 64.GB
    }
    withLabel: ultra {
        cpus = 32
        memory = 64.GB
    }
}

profiles {
  conda {
    conda.enabled = true
    process.conda = "${projectDir}/environments/environment.yml"
    conda.useMamba = true
    if (params.cache) {
      conda.cacheDir = params.cache
    }
  }
}

report {
    enabled = true
    file = "${params.outdir}/${params.run_name}_report.html"
    overwrite = true 
}

timeline {
    enabled = true
    file = "${params.outdir}/${params.run_name}_timeline.html"
    overwrite = true 
}

trace {
    enabled = true
    overwrite = true
    file = "${params.outdir}/${params.run_name}_trace.txt"
}
